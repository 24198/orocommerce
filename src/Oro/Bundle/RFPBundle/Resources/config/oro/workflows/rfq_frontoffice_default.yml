workflows:
    rfq_frontoffice_default:
        entity: Oro\Bundle\RFPBundle\Entity\Request
        entity_attribute: request

        defaults: {active: true}
        applications: ['commerce']

        exclusive_record_groups: ['b2b_rfq_frontoffice_flow']

        start_step: submitted
        steps_display_ordered: true
        steps:
            submitted:
                order: 10
                allowed_transitions:
                    - cancel_transition
                    - more_information_requested_transition
            requires_attention:
                order: 20
                allowed_transitions:
                    - provide_more_information_transition
            cancelled:
                order: 30
                allowed_transitions:
                    - resubmit_transition
                    - reopen_transition

        transitions:
            __start__:
                is_start: true
                is_hidden: true
                is_unavailable_hidden: true
                step_to: submitted
                transition_definition: __start___definition
            more_information_requested_transition:
                step_to: requires_attention
                transition_definition: stub_transition_definition
            provide_more_information_transition:
                step_to: submitted
                transition_definition: stub_transition_definition
            cancel_transition:
                step_to: cancelled
                transition_definition: cancel_transition_definition
            resubmit_transition:
                step_to: submitted
                transition_definition: stub_transition_definition
            reopen_transition:
                step_to: submitted
                transition_definition: stub_transition_definition

        transition_definitions:
            __start___definition:
                actions:
                    - '@request_enum_entity':
                        enum_code: 'rfp_internal_status'
                        attribute: $request.internalStatus
                        identifier: 'open'
                    - '@request_enum_entity':
                        enum_code: 'rfp_customer_status'
                        attribute: $request.customerStatus
                        identifier: 'submitted'
            cancel_transition_definition:
                actions:
                    - '@request_enum_entity':
                        enum_code: 'rfp_internal_status'
                        attribute: $request.internalStatus
                        identifier: 'cancelled_by_customer'
                    - '@request_enum_entity':
                        enum_code: 'rfp_customer_status'
                        attribute: $request.customerStatus
                        identifier: 'cancelled'
            stub_transition_definition: ~
