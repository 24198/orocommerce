actions:
    orob2b_sale_expire_quote_action:
        label: orob2b.sale.quote.actions.quote_expire
        enabled: true
        applications:
            - backend
            - frontend
        entities:
            - OroB2B\Bundle\SaleBundle\Entity\Quote
        order: 10
        frontend_options:
            icon: icon-time
        prefunctions:
            - @create_datetime:
                attribute: $.compare_date
            - @call_method:
                object: $.compare_date
                method: modify
                method_parameters: ['+7 days']
        preconditions:
            @or:
                - @and:
                    - @equal: [$expired, false]
                    - @not:
                        - @collection_element_value_exists: [$quoteProducts, $productSku, 'HSSUC']
                    - @or:
                        - @empty: $shipUntil
                        - @lt: [$shipUntil, $.compare_date]
                - @and:
                    - @equal: [$expired, false]
                    - @or:
                        - @empty: $shipUntil
                        - @gt: [$shipUntil, $.compare_date]
        postfunctions:
            - @assign_value: [$expired, true]
            - @flash_message:
                message: orob2b.sale.quote.message.quote.expire.success
                type: 'info'
                message_parameters:
                    id: $id
            - @redirect:
                route: 'orob2b_sale_quote_index'
