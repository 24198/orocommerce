{% extends 'OroLayoutBundle:Layout:div_layout.html.twig' %}

{% block form_field_widget %}
    {% set field_attr = form.vars.attr|merge({
    class: [
    form.vars.attr.class|default(''),
    class_prefix ~ "__form__input"
    ]|join(' ')
    }) %}
    {% set field_label_attr = form.vars.label_attr|merge({
    class: [
    form.vars.label_attr.class|default(''),
    class_prefix ~ "__form__label"
    ]|join(' ')
    }) %}
    {% set attr = attr|merge({
    class: [
    attr.class|default(''),
    "form-field-" ~ form.vars.name,
    "{{ class_prefix }}__form__row"
    ]|join(' ')
    }) %}
    <fieldset{{ block('block_attributes') }}>
        <div class="{{ class_prefix }}__form__col form__col_x12">
            {{ form_row(form, {
                label: label|default(null) ? label : form.vars.label,
                attr: field_attr,
                label_attr: field_label_attr
            }) }}
        </div>
    </fieldset>
{% endblock %}

{% block form_start_widget %}
    {% set attr = attr|merge({
    id: form.vars.id
    }) %}
    {{ parent() }}
{% endblock %}

{% block form_end_widget %}
    {{ parent() }}
    {{ oro_form_js_validation(form) }}
{% endblock %}

{#Action Buttons#}

{% block action_line_buttons_widget %}
    {% import 'OroActionBundle:layouts/base:layout.html.twig' as _layout %}
    <ul{{ block('block_attributes') }}>
        {% for action in actions %}
            <li>
                <a {{ _layout.get_action_attributes(dialogRoute, executionRoute, action, entityClass, entityId) }}>
                    {% if action.icon is not empty %}
                        <i class="{{ action.icon }} {{ action.buttonOptions.iCss|default('') }}"></i>
                    {% endif %}
                    {{ action.label|trim }}
                </a>
            </li>
        {% endfor %}
    </ul>
{% endblock %}

{% block action_combined_buttons_widget %}
    {% import 'OroActionBundle:layouts/base:layout.html.twig' as _layout %}
    {% set hasVariants = actions|length > 1 %}
    {% set additionalCss = "btn btn_orange" %}
    {% if hasVariants %}
        {% set additionalCss = additionalCss ~ " btn_has-dropdown btn_has-dropdown_xlg" %}
    {% endif %}
    {% set attr = attr|merge({ class: attr.class|default('') ~ additionalCss}) %}
    <div{{ block('block_attributes') }}>
        {% set action = actions|first %}
        {% set primaryButtonCss = 'direct-link ' ~ action.buttonOptions.class|default('') ~ " "  ~ params.buttonOptions.aCss|default('') %}
        <a {{ _layout.get_action_attributes(dialogRoute, executionRoute, action, entityClass, entityId, primaryButtonCss) }}>
            {{ action.label|trim }}
        </a>

        {% if hasVariants %}
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            <i class="material-icons">arrow_drop_down</i>
        </a>

        <ul class="dropdown-menu">
            {% for action in actions|slice(1) %}
            <li>
                <a {{ _layout.get_action_attributes(dialogRoute, executionRoute, action, entityClass, entityId, '') }}>
                    {{ action.label|trim }}
                </a>
            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>
{% endblock %}
