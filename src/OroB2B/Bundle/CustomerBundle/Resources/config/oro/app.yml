security:
    providers:
        b2b_frontend_user:
            id: orob2b_user.security.provider

    encoders:
        OroB2B\Bundle\CustomerBundle\Entity\AccountUser: sha512

    firewalls:
        frontend_login:
            pattern:                        ^/account/user/(login|reset-request|send-email|check-email|register)$
            provider:                       b2b_frontend_user
            anonymous:                      true

        frontend_confirm:
            pattern:                        ^/account/user/confirm/*
            provider:                       b2b_frontend_user
            anonymous:                      true

        # TODO: Add firewall rule for frontend user password reset BB-612

        frontend:
            pattern:                        ^/
            provider:                       b2b_frontend_user
            organization-form-login:
                csrf_provider:              form.csrf_provider
                check_path:                 orob2b_customer_account_user_security_check
                login_path:                 orob2b_customer_account_user_security_login
            logout:
                path:                       orob2b_customer_account_user_security_logout
            organization-remember-me:
                key:                        %secret%
                name:                       OROCOMMERCE
                lifetime:                   1209600   # stay logged for two weeks
                httponly:                   true
            anonymous:                      false
