definitions:
    change_category_position:
        label: 'Changed Category Position In Tree'
        enabled: true
        order: 20
        entity: OroB2B\Bundle\CatalogBundle\Entity\Category
        actions_configuration:
            - @change_category_position: ~

    # Category visibility update

    change_category_visibility:
        label: 'Changed Category Visibility For All'
        enabled: true
        order: 20
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\CategoryVisibility
        actions_configuration:
            - @change_category_visibility: ~

    change_account_group_category_visibility:
        label: 'Changed Category Visibility For Account Group'
        enabled: true
        order: 20
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountGroupCategoryVisibility
        actions_configuration:
            - @change_category_visibility: ~

    change_account_category_visibility:
        label: 'Changed Category visibility For Account'
        enabled: true
        order: 20
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountCategoryVisibility
        actions_configuration:
            - @change_category_visibility: ~

    # Product visibility update

    product_visibility_change:
        enabled: true
        label: 'Product visibility change'
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\ProductVisibility
        actions_configuration:
            - @resolve_product_visibility: ~

    account_group_product_visibility_change:
        enabled: true
        label: 'Account group product visibility change'
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountGroupProductVisibility
        actions_configuration:
            - @resolve_product_visibility: ~

    account_product_visibility_change:
        enabled: true
        label: 'Account product visibility change'
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountProductVisibility
        actions_configuration:
            - @resolve_product_visibility: ~

    product_create:
        enabled: true
        label: 'Product create'
        entity: OroB2B\Bundle\ProductBundle\Entity\Product
        actions_configuration:
            - @resolve_visibility_by_product: ~

    # Category visibility cache clear

    category_position_cache_clear:
        label: 'Clear Cache On Changing Category Position In Tree'
        enabled: true
        order: 10
        entity: OroB2B\Bundle\CatalogBundle\Entity\Category
        actions_configuration:
            - @category_visibility_cache_clear: ~

    account_group_changed_cache_clear:
        label: 'Clear Cache On Changing Category Position In Tree'
        enabled: true
        order: 10
        entity: OroB2B\Bundle\CatalogBundle\Entity\Category
        actions_configuration:
            - @category_visibility_cache_clear: ~

    category_visibility_cache_clear:
        label: 'Clear Cache On Changing Category Visibility For All'
        enabled: true
        order: 10
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\CategoryVisibility
        actions_configuration:
            - @category_visibility_cache_clear: ~

    account_group_category_visibility_cache_clear:
        label: 'Clear Cache On Changing Category Visibility For Account Group'
        enabled: true
        order: 10
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountGroupCategoryVisibility
        actions_configuration:
            - @category_visibility_cache_clear: ~

    account_category_visibility_cache_clear:
        label: 'Clear Cache On Changing Category Visibility For Account'
        enabled: true
        order: 10
        entity: OroB2B\Bundle\AccountBundle\Entity\Visibility\AccountCategoryVisibility
        actions_configuration:
            - @category_visibility_cache_clear: ~

    category_create:
        enabled: true
        label: 'Category create'
        entity: OroB2B\Bundle\CatalogBundle\Entity\Category
        actions_configuration:
            - @foreach: # for all products in new category
                array: $products
                value: $.product
                actions:
                    - @resolve_visibility_by_product:
                        entity: $.product

triggers:
    change_category_position:
        -
            event: update
            field: parentCategory

    change_category_visibility:
        -
            event: create
        -
            event: update
        -
            event: delete

    change_account_group_category_visibility:
        -
            event: create
        -
            event: update
        -
            event: delete

    change_account_category_visibility:
        -
            event: create
        -
            event: update
        -
            event: delete

    product_visibility_change:
        -
            event: create
        -
            event: update
        -
            event: delete

    account_group_product_visibility_change:
        -
            event: create
        -
            event: update

    account_product_visibility_change:
        -
            event: create
        -
            event: update

    category_position_cache_clear:
        -
            event: update
            field: parentCategory
        -
            event: delete

    account_group_changed_cache_clear:
        -
            event: update
            field: group

    category_visibility_cache_clear:
        -
            event: create
        -
            event: update
        -
            event: delete

    account_group_category_visibility_cache_clear:
        -
            event: create
        -
            event: update
        -
            event: delete

    account_category_visibility_cache_clear:
        -
            event: create
        -
            event: update
        -
            event: delete

    product_create:
        -
            event: create

    category_create:
        -
            event: create
