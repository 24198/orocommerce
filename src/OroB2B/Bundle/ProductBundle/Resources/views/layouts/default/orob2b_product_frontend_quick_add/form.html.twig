{% block orob2b_product_row_widget %}
    <fieldset class="{{ class_prefix }}__quote-form__row">
        <div class="{{ class_prefix }}__quote-form__col {{ class_prefix }}__quote-form__col_item">
            {{ form_widget(form.productSku, {attr: {placeholder: "orob2b.product.sku.placeholder", class: 'checkout__form__input'}}) }}
            <div class="product-autocomplete-success">
                {#todo move this icon to right #}
                {#<i class="icon-ok-circle"></i>#}
            </div>
            <div class="product-autocomplete-error" style="display: none;">
                <span class="validation-failed">SKU not found</span>
            </div>
            <div class="product-autocomplete-name"></div>
        </div>
        <div class="{{ class_prefix }}__quote-form__col {{ class_prefix }}__quote-form__col_qty">
            {{ form_widget(form.productQuantity, {attr: {placeholder: "orob2b.product.quantity.placeholder", class: 'checkout__form__input'}}) }}
            {{ form_errors(form.productQuantity) }}
        </div>
    </fieldset>
{% endblock %}

{% macro orob2b_product_row_collection_item_prototype(widget) %}
    {% if 'collection' in widget.vars.block_prefixes %}
        {% set form = widget.vars.prototype %}
        {% set name = widget.vars.full_name ~ '[' ~ widget.vars.prototype.vars.name ~ ']' %}
        {% set disabled = widget.vars.disabled %}
        {% set allow_delete = widget.vars.allow_delete %}
    {% else %}
        {% set form = widget %}
        {% set name = widget.vars.full_name %}
        {% set disabled = widget.parent.vars.disabled %}
        {% set allow_delete = widget.parent.vars.allow_delete %}
    {% endif %}

    <div data-content="{{ name }}" data-validation-optional-group {{ block('widget_container_attributes') }}>
        {{ form_widget(form) }}

        {% if allow_delete %}
            {#todo add this button after design #}
            {#<a class="removeRow icons-holder pull-right">[X]</a>#}
        {% endif %}
    </div>
{% endmacro %}

{% block orob2b_product_row_collection_widget %}
    {% spaceless %}
        {% if prototype is defined %}
            {% set prototype_html = _self.orob2b_product_row_collection_item_prototype(form) %}
        {% endif %}
        {% set attr = attr|merge({'class': (attr.class is defined ? attr.class ~ ' ' : '') ~  'grid-container' }) %}
        {% set id = id ~ '_collection' %}
        {% set prototype_name = form.vars.prototype_name %}
        <div {{ block('widget_container_attributes') }}>
            <div class="grid">
                <fieldset class="{{ class_prefix }}__quote-form__row {{ class_prefix }}__quote-form__row__head">
                    <div class="{{ class_prefix }}__quote-form__col {{ class_prefix }}__quote-form__col_item">
                        <label class="checkout__form__label checkout__form__label_additional">{{ 'orob2b.product.sku.label'|trans }}</label>
                    </div>
                    <div class="{{ class_prefix }}__quote-form__col {{ class_prefix }}__quote-form__col_qty">
                        <label class="checkout__form__label checkout__form__label_additional">{{ 'orob2b.product.quantity.label'|trans }}</label>
                    </div>
                </fieldset>

                <div class="oro-item-collection" data-last-index="{{ form.children|length }}" data-row-count-add="{{ form.vars.row_count_add }}"
                     data-prototype-name="{{ prototype_name }}"{% if prototype_html is defined %} data-prototype="{{ prototype_html|escape }}"{% endif %}>
                    {% if form.children|length %}
                        {% for child in form.children %}
                            {{ _self.orob2b_product_row_collection_item_prototype(child) }}
                        {% endfor %}
                    {% elseif show_form_when_empty and prototype_html is defined %}
                        {% for i in 0..(form.vars.row_count_initial - 1) %}
                            {{ prototype_html|replace({(prototype_name): i})|raw }}
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% if allow_add %}
            <fieldset class="{{ class_prefix }}__quote-form__row">
                <div class="{{ class_prefix }}__quote-form__col {{ class_prefix }}__quote-form__col_full">
                    <a href="#" class="add-more-rows-btn add-list-item" data-container=".oro-item-collection"
                       href="javascript: void(0);">
                        <i class="material-icons fs18 blue">add_circle</i>
                        <span>{{ form.vars.add_label|default('oro.form.collection.add')|trans }}</span>
                    </a>
                </div>
            </fieldset>
        {% endif %}
    {% endspaceless %}
{% endblock %}